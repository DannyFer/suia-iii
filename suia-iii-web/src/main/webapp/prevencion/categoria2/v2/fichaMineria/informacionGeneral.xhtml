 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/default.xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:mae="http://java.sun.com/jsf/composite/mae-composite"
	xmlns:mae-components="http://ec.gob.ambiente/mae-components"
	xmlns:control="http://java.sun.com/jsf/composite/controles-prime">
	<ui:define name="content">
        <f:event type="preRenderView" listener="#{informacionGeneralController.validarTareaBpmV2()}"/>
		<ui:include src="contenido/menuMineria.xhtml" />
		<div class="content">
			<h:form id="frmInformacion">
				<p:panel id="informacionGeneral"
					header="#{msg['label.categoriaii.mineria.seccionUno']}">
					<p:panelGrid columns="1" layout="grid" styleClass="w100"
						columnClasses="w25, field_mrg w25">
						<f:facet name="header">
							<mae:panelGridHeaderHelp
								value="#{msg['label.categoriaii.mineria.seccionUno.1.datosTitularMinero']}"
								conector="generalHelp"
								image="#{request.contextPath}/resources/images/help-how.png"
								help="#{helps['registro.general']}" />
						</f:facet>

						<h:panelGrid columns="2" layout="grid" styleClass="w100"
							columnClasses="w25, field_mrg w25">
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.1.datosTitularMinero']}" />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.proyectoLicenciamientoAmbiental.usuario.persona.nombre}" />

							<p:outputLabel />
							<p:outputLabel />
							<p:outputLabel />
							<p:outputLabel />
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.1.codigoMinero']}" />
							<h:panelGroup>
								<h:panelGrid columns="2">
									<p:inputText disabled="true"
										value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.proyectoLicenciamientoAmbiental.mineroArtesanal.codigo}">
									</p:inputText>
								</h:panelGrid>
							</h:panelGroup>

							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.1.fechaPermiso']}"
								for="fechaPermiso" />
							<h:panelGroup>
								<h:panelGrid columns="2">
									<p:calendar id="fechaPermiso" label="Fecha de otorgamiento del permiso"
										showButtonPanel="true" navigator="true" locale="es"
										value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.fechaEmisionPermiso}"
										styleClass="w100" pattern="dd/MM/yyyy" />
									<p:tooltip for="fechaPermiso" escape="false" showDelay="1200" trackMouse="true">
										<h:outputText value="#{helps['registro.fechaPermiso']}" escape="false" />
									</p:tooltip>
								</h:panelGrid>
							</h:panelGroup>

							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.1.fechaInscripcion']}"
								for="fechaInscripcion" />
							<h:panelGroup>
								<h:panelGrid columns="2">
									<p:calendar id="fechaInscripcion"
										label="#{msg['label.categoriaii.mineria.seccionUno.1.fechaInscripcion']}"
										showButtonPanel="true" navigator="true" locale="es"
										value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.fecharegistroContrato}"
										 styleClass="w100" pattern="dd/MM/yyyy" />
									<p:tooltip for="fechaInscripcion" escape="false"
										showDelay="1200" trackMouse="true">
										<h:outputText value="#{helps['registro.fechaContrato']}"
											escape="false" />
									</p:tooltip>
								</h:panelGrid>
							</h:panelGroup>

							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.1.duracionPermiso']}"
								for="duracionPermiso" />
							<h:panelGroup>
								<h:panelGrid columns="2">
									<p:inputText
										value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.duracionPermiso}"
										id="duracionPermiso"  maxlength="3">
										<pe:keyFilter mask="num" />
									</p:inputText>
								</h:panelGrid>
							</h:panelGroup>

							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.1.duracionContrato']}"
								for="duracionContrato" />
							<h:panelGroup>
								<h:panelGrid columns="2">
									<p:inputText
										value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.duracionContrato}"
										id="duracionContrato"  maxlength="3">
										<pe:keyFilter mask="num" />
									</p:inputText>
								</h:panelGrid>
							</h:panelGroup>
						</h:panelGrid>
						<h:panelGrid columns="1" width="100%" columnClasses="col1,col2">
							<p:outputLabel value="#{msg['label.observation']}" />
							<h:panelGroup>
								<p:inputTextarea
									value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.observaciones}"
									id="observacion" rows="5" styleClass="w100" autoResize="false"
									maxlength="250">
								</p:inputTextarea>
								<p:tooltip for="observacion" escape="false" showDelay="1200"
									trackMouse="true">
									<h:outputText value="#{helps['registro.nombre']}"
										escape="false" />
								</p:tooltip>
							</h:panelGroup>
						</h:panelGrid>
					</p:panelGrid>

					<br />
					<p:panelGrid columns="1" layout="grid" styleClass="w100"
						columnClasses="w25, field_mrg w25">
						<f:facet name="header">
							<mae:panelGridHeaderHelp
								value="#{msg['label.categoriaii.mineria.seccionUno.2']}"
								conector="generalHelp"
								image="#{request.contextPath}/resources/images/help-how.png"
								help="#{helps['registro.general']}" />
						</f:facet>

						<h:panelGrid columns="1" layout="grid" styleClass="w100"
							columnClasses="w50, field_mrg w50">
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.1.datosTitularMinero']}" />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.fichaAmbientalMineria.proyectoLicenciamientoAmbiental.usuario.persona.nombre}" />
						</h:panelGrid>

						<h:panelGrid columns="2" layout="grid" styleClass="w100"
							columnClasses="w50, field_mrg w50">
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.2.telefono']}" />
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.2.fax']}" />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.telefono}" />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.fax}" />

							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.2.correoElectronico']}" />
							<p:outputLabel value="" />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.email}" />
							<p:outputLabel value="" />
						</h:panelGrid>

						<h:panelGrid columns="2" layout="grid" styleClass="w100"
							columnClasses="w50, field_mrg w50">
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.2.provincia']}" />
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.2.ciudad']}" />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.ubicacionContacto.ubicacionesGeografica.ubicacionesGeografica.nombre}" />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.ubicacionContacto.ubicacionesGeografica.nombre}" />

							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.2.parroquia']}" />
							<p:outputLabel />
							<p:inputText disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.ubicacionContacto.nombre}" />
							<p:outputLabel />
						</h:panelGrid>

						<h:panelGrid columns="1" layout="grid" styleClass="w100"
							columnClasses="w50, field_mrg w50">
							<p:outputLabel
								value="#{msg['label.categoriaii.mineria.seccionUno.2.direcion']}" />
							<p:inputTextarea disabled="true"
								value="#{informacionGeneralController.informacionGeneralBean.direccion}" />

						</h:panelGrid>
					</p:panelGrid>
					<br />
					<p:panelGrid columns="1" layout="grid" styleClass="w100"
						columnClasses="w25, field_mrg w25">
						<f:facet name="header">
							<mae:panelGridHeaderHelp
								value="#{msg['label.categoriaii.mineria.seccionUno.3']}"
								conector="generalHelp"
								image="#{request.contextPath}/resources/images/help-how.png"
								help="#{helps['registro.general']}" />
						</f:facet>

						<h:panelGrid columns="1" layout="grid" styleClass="w100"
							columnClasses="w50, field_mrg w50">
							<p:dataTable id="tbl_ubicacion" styleClass="w100"
								columnClasses="w50, field_mrg w50"
								value="#{informacionGeneralController.informacionGeneralBean.listaUbicacionProyecto}"
								var="ubicacion" emptyMessage="#{labels['common.table.empty']}">
								<p:column headerText="Provincia">
									<h:outputText
										value="#{ubicacion.ubicacionesGeografica.ubicacionesGeografica.nombre}" />
								</p:column>
								<p:column headerText="Cantón">
									<h:outputText value="#{ubicacion.ubicacionesGeografica.nombre}" />
								</p:column>
								<p:column headerText="Parroquia">
									<h:outputText value="#{ubicacion.nombre}" />
								</p:column>
							</p:dataTable>
						</h:panelGrid>

						<br />
						<h:panelGrid columns="1" layout="grid" styleClass="w100"
							columnClasses="w50, field_mrg w50">
							<p:outputLabel
								value="Coordenadas UTM en el sistema WGS84, zona 17S"
								style="font-weight:bold;" />
							<br />
							<p:dataTable id="tbl_coordenadas" rowIndexVar="index"
								value="#{informacionGeneralController.informacionGeneralBean.proyecto.formasProyectos}"
								var="item" emptyMessage="#{labels['common.table.empty']}">
								<p:subTable value="#{item.coordenadas}" var="coordenada">
									<p:columnGroup type="header">
										<p:row>
											<p:column
												headerText="Grupo de coordenadas #{index + 1} (#{item.tipoForma})"
												colspan="5" />
										</p:row>
										<p:row>
											<p:column headerText="Shape"
												styleClass="alCenter table-column-header" />
											<p:column headerText="X"
												styleClass="alCenter table-column-header" />
											<p:column headerText="Y"
												styleClass="alCenter table-column-header" />
											<p:column headerText="Tipo"
												styleClass="alCenter table-column-header" />
											<p:column headerText="Descripci&oacute;n"
												styleClass="alCenter table-column-header" />
										</p:row>
									</p:columnGroup>
									<p:column headerText="Shape" styleClass="alCenter w15">
										<h:outputText value="#{coordenada.orden}" />
									</p:column>
									<p:column headerText="X" styleClass="alCenter w15">
										<h:outputText value="#{coordenada.x}" />
									</p:column>
									<p:column headerText="Y" styleClass="alCenter w15">
										<h:outputText value="#{coordenada.y}" />
									</p:column>
									<p:column headerText="Tipo" styleClass="alCenter w15">
										<h:outputText value="#{item.tipoForma}" />
									</p:column>
									<p:column headerText="Descripci&oacute;n" styleClass="alCenter">
										<h:outputText value="#{coordenada.descripcion}" />
									</p:column>
								</p:subTable>
							</p:dataTable>
						</h:panelGrid>
					</p:panelGrid>

					<br />
					<p:panelGrid columns="1" layout="grid" styleClass="w100"
						columnClasses="w25, field_mrg w25">
						<f:facet name="header">
							<mae:panelGridHeaderHelp
								value="Graficación de área solicitada a escala 1:50000 en mapa topográfico"
								conector="generalHelp"
								image="#{request.contextPath}/resources/images/help-how.png"
								help="#{helps['registro.general']}" />
						</f:facet>
						<h:panelGrid>
							<p:outputLabel value="*Adjuntar Documento (Formato PDF):" for="adjunto" />
							<p:fileUpload  id="adjunto" required="true"
								fileUploadListener="#{informacionGeneralController.handleFileUpload}"
								mode="advanced" label="Seleccione" auto="true"
								sizeLimit="1048576" allowTypes="/(\.|\/)(pdf)$/"
								update="nombreDoc" requiredMessage="El campo 'Adjuntar Documento (Formato PDF)' es requerido."
								invalidFileMessage="Tipo de archivo no válido, por favor seleccione un archivo de tipo PDF"
								invalidSizeMessage="Debe adjuntar un archivo no mayor de 1 Mb." />
							<p:commandLink id="nombreDoc" target="_blank"
								value="#{informacionGeneralController.informacionGeneralBean.entityAdjunto.nombre}"
								action="#{informacionGeneralController.descargar()}"
								ajax="false" />
						</h:panelGrid>
						
					</p:panelGrid>

					<br />
					<div class="buttons main">
						<p:commandButton value="Guardar" icon="ui-icon-check"
							action="#{informacionGeneralController.guardarFichaInformacionGeneral()}"
							update=":#{p:component('frmInformacion')}" />
					</div>
				</p:panel>
			</h:form>
		</div>
	</ui:define>
</ui:composition>