<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:controles="http://java.sun.com/jsf/composite/controles-prime"
      xmlns:pe="http://primefaces.org/ui/extensions">
<ui:composition template="/prevencion/licenciamiento-ambiental/eia/verEIA.xhtml">
    <ui:define name="content-eia">
        <h:form id="form">
            <p:panel header="Determinación del área de influencia">

                <p:panelGrid styleClass="w100" columns="1">
                    <f:facet name="header">
                        <h:outputText value="Documento de respaldo"/>
                    </f:facet>
                    <h:panelGrid styleClass="panel_data mw50" columns="2" columnClasses="header, null"
                                 rowClasses="null, alt">
                        <h:outputText id="etiqueta"
                                      value="#{areaInfluenciaBean.getDocumentoGeneral().getNombre()}"/>
                        <p:commandButton id="download" rendered="true"
                                         icon="ui-icon-search" ajax="false"
                                         styleClass="button-small primary" title="Ver" immediate="true">
                            <p:fileDownload value="#{areaInfluenciaBean.getStreamContent(areaInfluenciaBean.getDocumentoGeneral())}"/>
                        </p:commandButton>
                    </h:panelGrid>
					
					<!-- MarielaG para mostrar historico DOCUMENTOS HISTORICO-->
					<h:panelGrid styleClass="panel_data" columns="2"
						rendered="#{areaInfluenciaBean.listaDocumentosHistorico.size() > 0}"
						columnClasses="header background-orange, null"
						rowClasses="null, alt">
						<h:outputText id="headerDocHistorico"
							value="Historial documentos" />
						<p:commandButton styleClass="button-small primary" process="@this"
							icon="ui-icon-search"
							oncomplete="PF('documentosOriginalesDlg').show()" />
					</h:panelGrid>
					<!-- fin historico -->
				</p:panelGrid>

                <p:panelGrid columns="1" layout="grid" styleClass="w100" id="pnlGridInflDirecta">
                    <f:facet name="header">
                        <h:outputText value="Área de influencia directa"/>
                    </f:facet>
                    <h:outputLabel value="Componente físico" styleClass="bold"/>
                    <h:panelGrid styleClass="panel_data w100" columns="2" columnClasses="w25 header, null w75"
                                 rowClasses="null, alt">
                        <h:outputText value="Descripción" styleClass="bold"/>
                        <h:outputText id="dirFisDes"
                                      value="#{areaInfluenciaBean.areaInfluencia.directaFisicoDescripcion}"/>
                        <h:outputText value="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}" styleClass="bold"/>

                        <h:outputText id="dirFisDis"
                                      value="#{areaInfluenciaBean.areaInfluencia.directaFisicoDistancia} #{areaInfluenciaBean.areaInfluencia.directaFisicoDistanciaUnidad}"
                                      styleClass="w50"/>
                    </h:panelGrid>


                    <h:outputLabel value="Componente biótico" styleClass="bold"/>
                    <h:panelGrid styleClass="panel_data w100" columns="2" columnClasses="w25 header, null w75"
                                 rowClasses="null, alt">

                        <h:outputText value="Descripción" styleClass="bold"/>
                        <h:outputText id="dirBioDes"
                                      value="#{areaInfluenciaBean.areaInfluencia.directaBioticoDescripcion}"
                                />


                        <h:outputText value="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}" styleClass="bold"/>


                        <h:outputText id="dirBioDis"
                                      value="#{areaInfluenciaBean.areaInfluencia.directaBioticoDistancia} #{areaInfluenciaBean.areaInfluencia.directaBioticoDistanciaUnidad}"
                                />


                    </h:panelGrid>

					<!-- MarielaG para mostrar historico -->
					<h:panelGrid styleClass="panel_data" columns="2"
						rendered="#{areaInfluenciaBean.listaAreaDirectaFisicoHistorico.size() > 0 || areaInfluenciaBean.listaAreaDirectaBioticoHistorico.size() > 0}"
						columnClasses="header background-orange, null"
						rowClasses="null, alt">
						<h:outputText id="headerAreaDirecta"
							value="Área de influencia directa original" />
						<p:commandButton styleClass="button-small primary" process="@this"
							icon="ui-icon-search"
							oncomplete="PF('areaDirectaOriginalDlg').show()" />
					</h:panelGrid>
					<!-- fin historico -->

				</p:panelGrid>


                <p:panelGrid columns="1" layout="grid" styleClass="w100" id="pnlGridInflIndirecta">
                    <f:facet name="header">
                        <h:outputText value="Área de influencia indirecta"/>
                    </f:facet>
                    <h:outputLabel value="Componente físico" styleClass="bold"/>
                    <h:panelGrid styleClass="panel_data w100" columns="2" columnClasses="w25 header, null w75"
                                 rowClasses="null, alt">
                        <h:outputText value="Descripción" styleClass="bold"/>
                        <h:outputText id="indFisDes"
                                      value="#{areaInfluenciaBean.areaInfluencia.indirectaFisicoDescripcion}"/>


                        <h:outputText value="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}" styleClass="bold"/>


                        <h:outputText id="indFisDis" value="#{areaInfluenciaBean.areaInfluencia.indirectaFisicoDistancia} #{areaInfluenciaBean.areaInfluencia.indirectaFisicoDistanciaUnidad}"/>


                    </h:panelGrid>


                    <h:outputLabel value="Componente biótico" styleClass="bold"/>

                    <h:panelGrid styleClass="panel_data w100" columns="2" columnClasses="w25 header, w75 null"
                                 rowClasses="null, alt">
                        <h:outputText value="Descripción"  styleClass="bold"/>
                        <h:outputText id="indBioDes"
                                      value="#{areaInfluenciaBean.areaInfluencia.indirectaBioticoDescripcion}"
                                />


                        <h:outputText value="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}"  styleClass="bold"/>


                        <h:outputText id="indBioDis"
                                      value="#{areaInfluenciaBean.areaInfluencia.indirectaBioticoDistancia} #{areaInfluenciaBean.areaInfluencia.indirectaBioticoDistanciaUnidad}"
                                />

                    </h:panelGrid>

					<!-- MarielaG para mostrar historico -->
					<h:panelGrid styleClass="panel_data" columns="2"
						rendered="#{areaInfluenciaBean.listaAreaIndirectaFisicoHistorico.size() > 0 || areaInfluenciaBean.listaAreaIndirectaBioticoHistorico.size() > 0}"
						columnClasses="header background-orange, null"
						rowClasses="null, alt">
						<h:outputText id="headerAreaInDirecta"
							value="Área de influencia indirecta" />
						<p:commandButton styleClass="button-small primary" process="@this"
							icon="ui-icon-search"
							oncomplete="PF('areaIndirectaOriginalDlg').show()" />
					</h:panelGrid>
					<!-- fin historico -->
                </p:panelGrid>

                <p:panelGrid columns="1" layout="grid" styleClass="w100" id="pnlGridInfraestructura">
                    <f:facet name="header">
                        <h:outputText value="Determinación de áreas de influencia del proyecto medio social"/>
                    </f:facet>
                    <p:dataTable id="tableInfraestructura" value="#{areaInfluenciaBean.infraestructurasAfectadas}"
                                 var="infraestructura" emptyMessage="#{labels['common.table.empty']}">
                        <p:columnGroup type="header">
                            <p:row>
                                <p:column rowspan="2"
                                          headerText="Infraestructura y/o actividades a las que afecta el proyecto"/>
                                <p:column colspan="2" headerText="Área de influencia directa"/>
                                <p:column colspan="2" headerText="Área de influencia indirecta"/>
                                <p:column rowspan="2" headerText="" styleClass="w5" 
                                rendered="#{areaInfluenciaBean.infraestructurasAfectadasOriginales.size() > 0 || areaInfluenciaBean.totalInfraestructuraModificado > 0}"/>
                            </p:row>
                            <p:row>
                                <p:column headerText="Propietarios"/>
                                <p:column headerText="Comunidades, centros, poblados, etc."/>
                                <p:column headerText="Parroquias, territorios de nacionalidades indígenas, etc."/>
                                <p:column
                                        headerText="Otras jurisdicciones: Cantón, Provincia, etc. (Dependerá del alcance del proyecto)"/>
                            </p:row>
                        </p:columnGroup>
                        <p:column>
                            <h:outputText value="#{infraestructura.nombre}"/>
                        </p:column>
                        <p:column>
                            <h:outputText value="#{infraestructura.propietario}"/>
                        </p:column>
                        <p:column>
                            <h:outputText value="#{infraestructura.comunidad}"/>
                        </p:column>
                        <p:column>
                            <h:outputText value="#{infraestructura.lugar}"/>
                        </p:column>
                        <p:column>
                            <h:outputText value="#{infraestructura.otraJurisdiccion}"/>
                        </p:column>
                        <!-- MarielaG para mostrar historico INFRAESTRUCTURA-->
                        <p:column styleClass="w5 alCenter" rendered="#{areaInfluenciaBean.infraestructurasAfectadasOriginales.size() > 0 || areaInfluenciaBean.totalInfraestructuraModificado > 0}">
							<p:commandButton icon="ui-icon-search"
								rendered="#{infraestructura.registroModificado}"
								styleClass="button-small orange"
								action="#{areaInfluenciaBean.mostrarInfraestructuraOriginal(infraestructura)}"
								update=":formInfraestructuraOriginal:infraestructuraOriginalDlg" process="@this"
								oncomplete="PF('infraestructuraOriginalDlg').show()" />
 								<!-- REGISTRO NUEVO -->
							<h:outputText value="Nuevo" styleClass="bold text-orange" rendered="#{infraestructura.nuevoEnModificacion}"/>
						</p:column>
						<!-- fin historico -->
                    </p:dataTable>
                	
                	<!-- MarielaG para mostrar historico -->
					<h:panelGrid styleClass="panel_data" columns="2"
						rendered="#{areaInfluenciaBean.infraestructurasAfectadasEliminadasBdd.size() > 0}"
						columnClasses="header background-orange, null"
						rowClasses="null, alt">
						<h:outputText id="headerInfraestructuraHistorico"
							value="Áreas de influencia eliminadas" />
						<p:commandButton styleClass="button-small primary" process="@this"
							icon="ui-icon-search"
							action="#{areaInfluenciaBean.fillInfraestructurasEliminadas()}"
							update=":formInfraestructuraOriginal:infraestructuraOriginalDlg"
							oncomplete="PF('infraestructuraOriginalDlg').show()" />
					</h:panelGrid>
					<!-- fin historico -->
                </p:panelGrid>


                <p:panelGrid columns="1" layout="grid" styleClass="w100" id="pnlGridDistancias">
                    <f:facet name="header">
                        <h:outputText
                                value="Distancia entre elementos del proyecto y los elementos sensibles del medio social"/>
                    </f:facet>
                    <p:dataTable id="tableDistancias" value="#{areaInfluenciaBean.infraestructurasAfectadas}"
                                 var="infraestructura" emptyMessage="#{labels['common.table.empty']}"
                                 tableStyle="table-layout: auto">

                        <p:columnGroup type="header">

                            <p:row>
                                <p:column colspan="2" headerText="Distancias"/>
                            </p:row>
                            <p:row>
                                <p:column headerText="Infraestructura"/>
                                <p:column headerText="Elementos sensibles"/>

                            </p:row>

                        </p:columnGroup>

                        <p:column>
                            <h:outputText value="#{infraestructura.nombre}"/>
                        </p:column>
                        <p:column>
                            <p:dataTable var="distancia" value="#{infraestructura.distanciaElementoSensibles}"  
                            	emptyMessage="#{labels['common.table.empty']}">
                                <p:column headerText="Elemento">
                                    <h:outputText value="#{distancia.elementoSensible.nombre}"/>
                                </p:column>
                                <p:column headerText="Descripción">
                                    <h:outputText value="#{distancia.descripcion}"/>
                                </p:column>
                                <p:column headerText="Distancia (m)">
                                    <h:outputText value="#{distancia.distancia}"/>
                                </p:column>
								<!-- MarielaG para mostrar historico DISTANCIA-->
								<p:column styleClass="w5 alCenter"
									rendered="#{areaInfluenciaBean.distanciasOriginales.size() > 0}">
									<p:commandButton icon="ui-icon-search"
										rendered="#{distancia.registroModificado}"
										styleClass="button-small orange"
										action="#{areaInfluenciaBean.mostrarDistanciasOriginales(distancia)}"
										update=":formDistanciaOriginal:distanciaOriginalDlg"
										process="@this"
										oncomplete="PF('distanciaOriginalDlg').show()" />
									<!-- REGISTRO NUEVO -->
									<h:outputText value="Nuevo" styleClass="bold text-orange"
										rendered="#{distancia.nuevoEnModificacion}" />
								</p:column>
								<!-- fin historico -->
							</p:dataTable>
                        </p:column>
                    </p:dataTable>
                	
                	<!-- MarielaG para mostrar historico -->
					<h:panelGrid styleClass="panel_data" columns="2"
						rendered="#{areaInfluenciaBean.distanciasEliminadasBdd.size() > 0}"
						columnClasses="header background-orange, null"
						rowClasses="null, alt">
						<h:outputText id="headerDistanciasHistorico"
							value="Distancias eliminadas" />
						<p:commandButton styleClass="button-small primary" process="@this"
							icon="ui-icon-search"
							action="#{areaInfluenciaBean.fillDistanciasEliminadas()}"
							update=":formDistanciaOriginal:distanciaOriginalDlg"
							oncomplete="PF('distanciaOriginalDlg').show()" />
					</h:panelGrid>
					<!-- fin historico -->
                </p:panelGrid>
            </p:panel>
        </h:form>
        
        <!-- MarielaG para mostrar historico DOCUMENTOS-->
		<h:form id="formDocumentosOriginal">
			<p:dialog header="Historial de documentos"
				id="documentosOriginalesDlg" widgetVar="documentosOriginalesDlg"
				modal="true" resizable="false" width="600">
				<h:panelGroup id="datosDocumentosOriginal">
					<p:dataTable
						value="#{areaInfluenciaBean.listaDocumentosHistorico}"
						var="doc" paginator="true" rows="10" paginatorPosition="bottom"
						emptyMessage="#{labels['common.table.empty']}"
						paginatorAlwaysVisible="false">
						<p:column headerText="Fecha Modificación" styleClass="w15 alCenter">
							<h:outputText value="#{doc.fechaCreacion}" />
						</p:column>
						<p:column headerText="Documento">
							<h:outputText value="#{doc.nombre}" />
						</p:column>
						<p:column styleClass="w40px alCenter">
							<p:commandButton id="download_historico" rendered="true"
								icon="ui-icon-search" ajax="false"
								styleClass="button-small background-orange" title="Ver" immediate="true">
								<p:fileDownload
									value="#{areaInfluenciaBean.getStreamContent(doc)}" />
							</p:commandButton>
						</p:column>
					</p:dataTable>
				</h:panelGroup>
			</p:dialog>
		</h:form>
		<!-- fin historico -->
		
        <!-- MarielaG para mostrar historico AREA DIRECTA-->
		<h:form id="formAreaDirectaOriginal">
			<p:dialog header="Historial de área de influencia directa"
				id="areaDirectaOriginalDlg" widgetVar="areaDirectaOriginalDlg"
				modal="true" resizable="false" width="600">
				<h:panelGroup id="datosAreaDirectaOriginal">
					<h:outputLabel value="Componente físico" styleClass="bold" rendered="#{areaInfluenciaBean.listaAreaDirectaFisicoHistorico.size() > 0}" />
					<p:dataTable
						rendered="#{areaInfluenciaBean.listaAreaDirectaFisicoHistorico.size() > 0}"
						value="#{areaInfluenciaBean.listaAreaDirectaFisicoHistorico}"
						var="area" paginator="true" rows="10" paginatorPosition="bottom"
						emptyMessage="#{labels['common.table.empty']}"
						paginatorAlwaysVisible="false">
						<p:column headerText="Fecha Modificación" styleClass="w15 alCenter">
							<h:outputText value="#{area.fechaCreacion}" />
						</p:column>
						<p:column headerText="Descripción">
							<h:outputText value="#{area.directaFisicoDescripcion}" />
						</p:column>
						<p:column headerText="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}">
							<h:outputText value="#{area.directaFisicoDistancia} #{area.directaFisicoDistanciaUnidad}" />
						</p:column>
					</p:dataTable>
					<br></br>
					<h:outputLabel value="Componente biótico" styleClass="bold" rendered="#{areaInfluenciaBean.listaAreaDirectaBioticoHistorico.size() > 0}"/>
					<p:dataTable
						rendered="#{areaInfluenciaBean.listaAreaDirectaBioticoHistorico.size() > 0}"
						value="#{areaInfluenciaBean.listaAreaDirectaBioticoHistorico}"
						var="area" paginator="true" rows="10" paginatorPosition="bottom"
						emptyMessage="#{labels['common.table.empty']}"
						paginatorAlwaysVisible="false">
						<p:column headerText="Fecha Modificación" styleClass="w15 alCenter">
							<h:outputText value="#{area.fechaCreacion}" />
						</p:column>
						<p:column headerText="Descripción">
							<h:outputText value="#{area.directaBioticoDescripcion}" />
						</p:column>
						<p:column headerText="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}">
							<h:outputText value="#{area.directaBioticoDistancia} #{area.directaBioticoDistanciaUnidad}" />
						</p:column>
					</p:dataTable>
					<br></br>
				</h:panelGroup>
			</p:dialog>
		</h:form>
		<!-- fin historico -->

		<!-- MarielaG para mostrar historico AREA INDIRECTA-->
		<h:form id="formAreaIndirectaOriginal">
			<p:dialog header="Historial de área de influencia indirecta"
				id="areaIndirectaOriginalDlg" widgetVar="areaIndirectaOriginalDlg"
				modal="true" resizable="false" width="600">
				<h:panelGroup id="datosAreaIndirectaOriginal">
					<h:outputLabel value="Componente físico" styleClass="bold" rendered="#{areaInfluenciaBean.listaAreaIndirectaFisicoHistorico.size() > 0}" />
					<p:dataTable
						rendered="#{areaInfluenciaBean.listaAreaIndirectaFisicoHistorico.size() > 0}"
						value="#{areaInfluenciaBean.listaAreaIndirectaFisicoHistorico}"
						var="area" paginator="true" rows="10" paginatorPosition="bottom"
						emptyMessage="#{labels['common.table.empty']}"
						paginatorAlwaysVisible="false">
						<p:column headerText="Fecha Modificación" styleClass="w15 alCenter">
							<h:outputText value="#{area.fechaCreacion}" />
						</p:column>
						<p:column headerText="Descripción">
							<h:outputText value="#{area.indirectaFisicoDescripcion}" />
						</p:column>
						<p:column headerText="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}">
							<h:outputText value="#{area.indirectaFisicoDistancia} #{area.indirectaFisicoDistanciaUnidad}" />
						</p:column>
					</p:dataTable>
					<br></br>
					<h:outputLabel value="Componente biótico" styleClass="bold" rendered="#{areaInfluenciaBean.listaAreaIndirectaBioticoHistorico.size() > 0}" />
					<p:dataTable
						rendered="#{areaInfluenciaBean.listaAreaIndirectaBioticoHistorico.size() > 0}"
						value="#{areaInfluenciaBean.listaAreaIndirectaBioticoHistorico}"
						var="area" paginator="true" rows="10" paginatorPosition="bottom"
						emptyMessage="#{labels['common.table.empty']}"
						paginatorAlwaysVisible="false">
						<p:column headerText="Fecha Modificación" styleClass="w15 alCenter">
							<h:outputText value="#{area.fechaCreacion}" />
						</p:column>
						<p:column headerText="Descripción">
							<h:outputText value="#{area.indirectaBioticoDescripcion}" />
						</p:column>
						<p:column headerText="#{areaInfluenciaBean.esMineriaNoMetalicos?'Área':'Distancia'}">
							<h:outputText value="#{area.indirectaBioticoDistancia} #{area.indirectaBioticoDistanciaUnidad}" />
						</p:column>
					</p:dataTable>
					<br></br>
				</h:panelGroup>
			</p:dialog>
		</h:form>
		<!-- fin historico -->

		<!-- MarielaG para mostrar historico INFRAESTRUCTURA-->
		<h:form id="formInfraestructuraOriginal">
			<p:dialog header="Historial de áreas de influencia"
				id="infraestructuraOriginalDlg"
				widgetVar="infraestructuraOriginalDlg" modal="true"
				resizable="false" width="800">
				<h:panelGroup id="datosInfraestructuraOriginal">
					<p:dataTable id="tableInfraestructura"
						value="#{areaInfluenciaBean.infraestructurasAfectadasHistorial}"
						var="infraestructura"
						emptyMessage="#{labels['common.table.empty']}">
						<p:columnGroup type="header">
							<p:row>
								<p:column rowspan="2" headerText="Fecha Modificación" styleClass="w15" />
								<p:column rowspan="2"
									headerText="Infraestructura y/o actividades a las que afecta el proyecto" />
								<p:column colspan="2" headerText="Área de influencia directa" />
								<p:column colspan="2" headerText="Área de influencia indirecta" />
							</p:row>
							<p:row>
								<p:column headerText="Propietarios" />
								<p:column headerText="Comunidades, centros, poblados, etc." />
								<p:column
									headerText="Parroquias, territorios de nacionalidades indígenas, etc." />
								<p:column
									headerText="Otras jurisdicciones: Cantón, Provincia, etc. (Dependerá del alcance del proyecto)" />
							</p:row>
						</p:columnGroup>
						<p:column styleClass="w10">
							<h:outputText value="#{infraestructura.fechaCreacion}" />
						</p:column>
						<p:column>
							<h:outputText value="#{infraestructura.nombre}" />
						</p:column>
						<p:column>
							<h:outputText value="#{infraestructura.propietario}" />
						</p:column>
						<p:column>
							<h:outputText value="#{infraestructura.comunidad}" />
						</p:column>
						<p:column>
							<h:outputText value="#{infraestructura.lugar}" />
						</p:column>
						<p:column>
							<h:outputText value="#{infraestructura.otraJurisdiccion}" />
						</p:column>
					</p:dataTable>

				</h:panelGroup>
			</p:dialog>
		</h:form>
		<!-- fin historico -->
		
		<!-- MarielaG para mostrar historico DISTANCIAS-->
		<h:form id="formDistanciaOriginal">
			<p:dialog
				header="Historial de distancias"
				id="distanciaOriginalDlg" widgetVar="distanciaOriginalDlg"
				modal="true" resizable="false" width="700">
				<h:panelGroup id="datosDistanciaOriginal">
					<p:dataTable id="tableDistancias"
						value="#{areaInfluenciaBean.distanciasHistorial}" var="distancia"
						emptyMessage="#{labels['common.table.empty']}"
						tableStyle="table-layout: auto">
						<p:columnGroup type="header">
							<p:row>
								<p:column rowspan="2" headerText="Fecha Modificación" styleClass="w15 alCenter"/>
								<p:column rowspan="2" headerText="Infraestructura" />
								<p:column colspan="3" headerText="Elementos sensibles" />
							</p:row>
							<p:row>
								<p:column headerText="Elemento" />
								<p:column headerText="Descripción" />
								<p:column headerText="Distancia (m)" />
							</p:row>
						</p:columnGroup>
						<p:column styleClass="w15 alCenter">
							<h:outputText value="#{distancia.fechaCreacion}" />
						</p:column>
						<p:column>
							<h:outputText value="#{distancia.infraestructuraAfectada.nombre}" />
						</p:column>
						<p:column headerText="Elemento">
							<h:outputText value="#{distancia.elementoSensible.nombre}" />
						</p:column>
						<p:column headerText="Descripción">
							<h:outputText value="#{distancia.descripcion}" />
						</p:column>
						<p:column headerText="Distancia (m)">
							<h:outputText value="#{distancia.distancia}" />
						</p:column>

					</p:dataTable>

				</h:panelGroup>
			</p:dialog>
		</h:form>
		<!-- fin historico -->
        
    </ui:define>
</ui:composition>
</html>