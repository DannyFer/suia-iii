<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:control="http://java.sun.com/jsf/composite/controles-prime"
                xmlns:mae="http://java.sun.com/jsf/composite/mae-composite">
    <h:form rendered="#{faunaController.faunaBean.idTipoMuestreo != null and faunaController.faunaBean.grupoTaxonomicoSeleccionado.id == faunaController.faunaBean.idHerpetofauna}">
        <p:panelGrid columns="1" layout="grid" styleClass="w100" columnClasses="" >
            <f:facet name="header">
                <p:commandButton value="Adicionar"  styleClass="button-small-text toRight field_mrg" icon="ui-icon-plusthick" 
                                 action="#{faunaController.agregarIndividuo(1)}" update=":#{p:component('frmDetalleHerpetofauna1')}" 
                                 oncomplete="PF('dlgDetalleHerpetofauna1').show();"                />
                <mae:panelGridHeaderHelp value="Cuantitativo por individuos" conector="ubicacionHelp" image="#{request.contextPath}/resources/images/proyecto-mapa.png" help="" />

            </f:facet>
            <p:dataTable id="tblClIndividuoHerpetofauna1" value="#{faunaController.faunaBean.listaDetalleFauna1}"
                         var="individuo" paginator="true" rows="10" paginatorPosition="bottom" scrollable="true" scrollWidth="700"
                         emptyMessage="#{labels['common.table.empty']}">
                <p:column headerText="Acciones" width="60">
                    <div class="buttons-inline">
                        <p:commandButton icon="ui-icon-pencil" action="#{faunaController.seleccionarDetalleFauna1(individuo)}"
                                         title="Editar" styleClass="primary"
                                         oncomplete="PF('dlgDetalleHerpetofauna1').show();" update=":#{p:component('frmDetalleHerpetofauna1')}"/>
                        <p:commandButton icon="ui-icon-trash" action="#{faunaController.removerDetalleFuna1(individuo)}"
                                         title="Remover" styleClass="secondary"
                                         update="tblClIndividuoHerpetofauna1"/>
                    </div>
                </p:column>
                <p:column headerText="Punto de muestreo" width="240">
                    <center>
                        <control:combo identificador="cmbPuntoTbl1" lista="#{faunaController.faunaBean.listaCodigoPunto1}" 
                                       valor="#{individuo.idPuntoMuestreo}" habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="N° de registro" width="50">
                    <center>
                        <h:outputText value="#{individuo.numeroRegistro}"/>
                    </center>
                </p:column>
                <p:column headerText="Órden" width="240">
                    <center>
                        <h:outputText value="#{individuo.orden}" />
                    </center>
                </p:column>
                <p:column headerText="Familia" width="240">
                    <center>
                        <h:outputText value="#{individuo.familia}"/>
                    </center>
                </p:column>
                <p:column headerText="Género" width="240">
                    <center>
                        <h:outputText value="#{individuo.genero}" />
                    </center>
                </p:column>
                <p:column headerText="Especie" width="240">
                    <center>
                        <h:outputText value="#{individuo.especie}"/>
                    </center>
                </p:column>
                <p:column headerText="Nombre común" width="240">
                    <center>
                        <h:outputText value="#{individuo.nombreComun}" />
                    </center>
                </p:column>
                <p:column headerText="Tipo registro" width="240">
                    <center>
                        <control:combo valor="#{individuo.idTipoRegistro}" habilitar="true"
                                       lista="#{combosFaunaController.listaTipoRegistro}" 
                                       identificador="cmbTipoRegistroTbl1"/>
                        <h:outputText value="#{faunaController.faunaBean.detalleFauna1.descOtrosRastrosTipoRegistro}" />
                    </center>
                </p:column>
                <p:column headerText="Tipo vegetación" width="240">
                    <center>
                        <control:combo identificador="cmbTipoVegetacionTbl1" 
                                       lista="#{combosFaunaController.listaTipoVegetacion}" 
                                       valor="#{individuo.idTipoVegetacion}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Condiciones Climáticas" width="240">
                    <center>
                        <control:combo identificador="cmbCondicionesClimaticasTbl1" 
                                       lista="#{combosFaunaController.listaCondicionesClimaticas}" 
                                       valor="#{individuo.idCondicionesClimaticas}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Fase lunar" width="240">
                    <center>
                        <control:combo identificador="cmbFaseLunarTbl1" 
                                       lista="#{combosFaunaController.listaFaseLunar}" 
                                       valor="#{individuo.idFaseLunar}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Distribución vertical de la especie" width="240">
                    <center>
                        <control:combo valor="#{individuo.idDistribucionVerticalEspecie}" 
                                       lista="#{combosFaunaController.listaDistribucionVerticalEspecie}" 
                                       identificador="cmbDisTipoRegistroTbl1" 
                                       habilitar="true" />
                        <h:outputText value="#{individuo.descOtrosDistribucionVerticalEspecie}" />
                    </center>
                </p:column>

                <p:column headerText="Gremio alimenticio" width="240">
                    <center>
                        <control:combo valor="#{individuo.idGremioAlimenticio}" 
                                       lista="#{combosFaunaController.listaGremioAlimenticio}" identificador="cmbGremioTbl1" 
                                       habilitar="true"/>                        

                        <h:outputText value="#{individuo.descOtrosGremioAlimenticio}" />
                    </center>
                </p:column>
                <p:column headerText="Patrón actividad" width="240">
                    <center>
                        <control:combo identificador="cmbPatronTbl1" 
                                       lista="#{combosFaunaController.listaPatronActividad}" 
                                       valor="#{individuo.idPatronActividad}"
                                       habilitar="true"/>
                    </center>
                </p:column>

                <p:column headerText="Modo Reproductivo" width="240">
                    <center>
                        <control:combo identificador="cmbModoReproductivoTbl" 
                                       lista="#{combosFaunaController.listaModosReproduccion}" 
                                       valor="#{individuo.idModoReproductivo}" 
                                       habilitar="true"/>
                    </center>
                </p:column>

                <p:column headerText="Sensibilidad" width="240">
                    <center>
                        <control:combo identificador="cmbSensibildadTbl1" 
                                       lista="#{combosFaunaController.listaSencibilidad}" 
                                       valor="#{individuo.idSensibilidad}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Criterio sensibilidad" width="240">
                    <center>
                        <h:outputText value="#{individuo.criterioSencibilidad}" />
                    </center>
                </p:column>
                <p:column headerText="Especies migratorias" width="240">
                    <center>
                        <control:combo identificador="cmbEspeciesMigratoriasTbl1" 
                                       lista="#{combosFaunaController.listaEspeciesMigratorias}" 
                                       valor="#{individuo.idEspeciesMigratorias}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Especies bioindicadoras del estado de conservación" width="240">
                    <center>
                        <control:combo identificador="cmbEspeciesBioticasTbl1" 
                                       lista="#{combosFaunaController.listaEspeciesBioindicadoras}" 
                                       valor="#{individuo.idEspeciesBioindicadoras}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Criterio de indicador" width="240">
                    <center>
                        <h:outputText value="#{individuo.criterio}" />
                    </center>
                </p:column>
                <p:column headerText="Uso" width="240">
                    <center>
                        <control:combo identificador="cmbUsoTbl1" 
                                       lista="#{combosFaunaController.listaUso}" 
                                       valor="#{individuo.idUso}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Endémica" width="240">
                    <center>
                        <control:combo identificador="cmbEspEndemicaTbl" 
                                       lista="#{combosFaunaController.listaColectasIncidentales}" 
                                       valor="#{individuo.idEspecieEndemica}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="UICN Internacional" width="240">
                    <center>
                        <control:combo identificador="cmbUICNTbl1" 
                                       lista="#{combosFaunaController.listaUICN}" 
                                       valor="#{individuo.idUicnInternacional}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Cites" width="240">
                    <center>
                        <control:combo identificador="cmbCitesTbl1" 
                                       lista="#{combosFaunaController.listaCities}" 
                                       valor="#{individuo.idCites}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Libro rojo" width="240">
                    <center>
                        <control:combo identificador="cmbLibroRojoTbl1" 
                                       lista="#{combosFaunaController.listaLibroRojo}" 
                                       valor="#{individuo.idLibroRojoEcuador}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Colectas incidentales" width="240">
                    <center>
                        <control:combo identificador="cmbColectasTbl1" 
                                       lista="#{combosFaunaController.listaColectasIncidentales}" 
                                       valor="#{individuo.idColectasIncidentales}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="N° colección del centro de tenencia" width="240">
                    <center>
                        <h:outputText value="#{individuo.coleccionCentroTenencia}" />
                    </center>
                </p:column>
                <p:column headerText="Centro tenencia autorizado" width="240">
                    <center>
                        <h:outputText value="#{individuo.centroTeneciaAutorizado}" />
                    </center>
                </p:column>
                <p:column headerText="Foto (gif,jpg,png)" width="240">
                    <center>
                        <h:outputText value="#{individuo.adjunto.nombre}" />
                    </center>
                </p:column>
                <p:column headerText="Descripción foto" width="240">
                    <center>
                        <h:outputText value="#{individuo.descripcionFoto}" />
                    </center>
                </p:column>

            </p:dataTable>
        </p:panelGrid>
        <br/>
    </h:form>

    <p:dialog header="Detalle fauna" widgetVar="dlgDetalleHerpetofauna1" modal="true" resizable="false" draggable="false"
              style="overflow: auto;" width="868" height="450">  
        <h:form id="frmDetalleHerpetofauna1">
            <p:panel>
                <h:panelGrid columns="4">
                    <h:outputLabel value="*Punto de muestreo:"/>
                    <control:combo identificador="cmbPunto1" lista="#{faunaController.faunaBean.listaCodigoPunto1}" valor="#{faunaController.faunaBean.detalleFauna1.idPuntoMuestreo}" requerido="true"/>
                    <h:outputLabel value="*N° de registro:"/>
                    <h:outputText value="#{faunaController.faunaBean.detalleFauna1.numeroRegistro}"/>
                    <h:outputLabel value="*Órden:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.orden}" identificador="txtOrden1" tamanio="10" longitud="100" requerido="true"/>
                    <h:outputLabel value="*Familia:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.familia}" identificador="txtFamilia1" tamanio="30" longitud="100" requerido="true"/>
                    <h:outputLabel value="*Género:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.genero}" identificador="txtGenero1" tamanio="30" longitud="100" requerido="true"/>
                    <h:outputLabel value="*Especie:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.especie}" identificador="txtEspecie1" tamanio="30" longitud="100" requerido="true"/>
                    <h:outputLabel value="*Nombre común:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.nombreComun}" identificador="txtNombreComun1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Tipo registro:"/>
                    <h:panelGroup id="pgTipoRegistro1">
                        <control:comboAjax valor="#{faunaController.faunaBean.detalleFauna1.idTipoRegistro}" lista="#{combosFaunaController.listaTipoRegistro}" identificador="cmbTipoRegistro1" 
                                           ajax="#{faunaController.cargarOtrosTipoRegistro()}" idComponenteActualizar="pgTipoRegistro1"/>
                        <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.descOtrosRastrosTipoRegistro}" identificador="txtOtrosTp1" tamanio="30" longitud="100" requerido="#{faunaController.faunaBean.detalleFauna1.idTipoRegistro.toString().equals(faunaController.faunaBean.detalleFauna1.idOtrosRastrosTipoRegistro)}" rendered="#{ (faunaController.faunaBean.detalleFauna1.idTipoRegistro.toString().equals(faunaController.faunaBean.detalleFauna1.idOtrosRastrosTipoRegistro))}"/>
                    </h:panelGroup>
                    <h:outputLabel value="*Tipo vegetación:"/>
                    <control:combo identificador="cmbTipoVegetacion1" lista="#{combosFaunaController.listaTipoVegetacion}" valor="#{faunaController.faunaBean.detalleFauna1.idTipoVegetacion}" requerido="true"/>

                    <h:outputLabel value="*Condiciones Climáticas:"/>
                    <control:combo identificador="cmbCondicionesClimáticas1" lista="#{combosFaunaController.listaCondicionesClimaticas}" valor="#{faunaController.faunaBean.detalleFauna1.idCondicionesClimaticas}" requerido="true"/>

                    <h:outputLabel value="*Fase lunar:"/>
                    <control:combo identificador="cmbCondicionesClimáticas1" lista="#{combosFaunaController.listaFaseLunar}" valor="#{faunaController.faunaBean.detalleFauna1.idFaseLunar}" requerido="true"/>

                    <h:outputLabel value="*Distribución vertical de la especie:"/>
                    <h:panelGroup id="pgDistribucion1">
                        <control:comboAjax valor="#{faunaController.faunaBean.detalleFauna1.idDistribucionVerticalEspecie}" lista="#{combosFaunaController.listaDistribucionVerticalEspecie}" identificador="cmbTipoRegistro1" 
                                           ajax="#{faunaController.cargarOtrosDistribucionVerticalEspecie()}" idComponenteActualizar="pgDistribucion1"/>                        
                        <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.descOtrosDistribucionVerticalEspecie}" identificador="txtOtrosTp1" tamanio="30" longitud="100" requerido="#{faunaController.faunaBean.detalleFauna1.idDistribucionVerticalEspecie.toString().equals(faunaController.faunaBean.detalleFauna1.idOtrosDistribucionVerticalEspecie)}" rendered="#{ (faunaController.faunaBean.detalleFauna1.idDistribucionVerticalEspecie.toString().equals(faunaController.faunaBean.detalleFauna1.idOtrosDistribucionVerticalEspecie))}"/>
                    </h:panelGroup>

                    <h:outputLabel value="*Gremio alimenticio:"/>
                    <h:panelGroup id="pgGremio1">
                        <control:comboAjax valor="#{faunaController.faunaBean.detalleFauna1.idGremioAlimenticio}" lista="#{combosFaunaController.listaGremioAlimenticio}" identificador="cmbTipoRegistro1" 
                                           ajax="#{faunaController.cargarOtrosGremioAlimenticio()}" idComponenteActualizar="pgGremio1"/>                        

                        <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.descOtrosGremioAlimenticio}" identificador="txtOtrosTp1" tamanio="30" longitud="100" requerido="#{faunaController.faunaBean.detalleFauna1.idGremioAlimenticio.toString().equals(faunaController.faunaBean.detalleFauna1.idOtrosGremioAlimenticio)}" rendered="#{ (faunaController.faunaBean.detalleFauna1.idGremioAlimenticio.toString().equals(faunaController.faunaBean.detalleFauna1.idOtrosGremioAlimenticio))}"/>
                    </h:panelGroup>

                    <h:outputLabel value="*Patrón actividad:"/>
                    <control:combo identificador="cmbPatronActividad1" lista="#{combosFaunaController.listaPatronActividad}" valor="#{faunaController.faunaBean.detalleFauna1.idPatronActividad}" requerido="true"/>

                    <h:outputLabel value="*Modo reproductivo:"/>
                    <control:combo identificador="cmbModoReproductivo1" lista="#{combosFaunaController.listaModosReproduccion}" valor="#{faunaController.faunaBean.detalleFauna1.idModoReproductivo}" requerido="true"/>

                    <h:outputLabel value="*Sensibilidad:"/>
                    <control:combo identificador="cmbCondicionesClimáticas1" lista="#{combosFaunaController.listaSencibilidad}" valor="#{faunaController.faunaBean.detalleFauna1.idSensibilidad}" requerido="true"/>

                    <h:outputLabel value="*Criterio sensibilidad:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.criterioSencibilidad}" identificador="txtPunto1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Especies bioindicadoras del estado de conservación:"/>
                    <control:combo identificador="cmbCondicionesClimáticas1" lista="#{combosFaunaController.listaEspeciesBioindicadoras}" valor="#{faunaController.faunaBean.detalleFauna1.idEspeciesBioindicadoras}" requerido="true"/>

                    <h:outputLabel value="*Criterio indicador:"/>                
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.criterio}" identificador="txtPunto1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Uso:"/>
                    <control:combo identificador="cmbCondicionesClimaticas1" lista="#{combosFaunaController.listaUso}" valor="#{faunaController.faunaBean.detalleFauna1.idUso}" requerido="true"/>

                    <h:outputLabel value="*Endémica:"/>
                    <control:combo identificador="cmbEndemica" lista="#{combosFaunaController.listaColectasIncidentales}" valor="#{faunaController.faunaBean.detalleFauna1.idEspecieEndemica}" requerido="true"/>


                    <h:outputLabel value="*UICN Internacional:"/>
                    <control:combo identificador="cmbCondicionesClimaticas1" lista="#{combosFaunaController.listaUICN}" valor="#{faunaController.faunaBean.detalleFauna1.idUicnInternacional}" requerido="true"/>

                    <h:outputLabel value="*Cites:"/>
                    <control:combo identificador="cmbCondicionesClimaticas1" lista="#{combosFaunaController.listaCities}" valor="#{faunaController.faunaBean.detalleFauna1.idCites}" requerido="true"/>

                    <h:outputLabel value="*Libro rojo:"/>
                    <control:combo identificador="cmbCondicionesClimaticas1" lista="#{combosFaunaController.listaLibroRojo}" valor="#{faunaController.faunaBean.detalleFauna1.idLibroRojoEcuador}" requerido="true"/>

                    <h:outputLabel value="*Colectas incidentales:"/>
                    <control:combo identificador="cmbCondicionesClimaticas1" lista="#{combosFaunaController.listaColectasIncidentales}" valor="#{faunaController.faunaBean.detalleFauna1.idColectasIncidentales}" requerido="true"/>

                    <h:outputLabel value="*N° colección del centro de tenencia:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.coleccionCentroTenencia}" identificador="txtPuntsso1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Centro tenencia autorizado:"/>
                    <control:todoTextoComoIngrese identificador="txtCentroTenencia1" tamanio="30"
                                                  valor="#{faunaController.faunaBean.detalleFauna1.centroTeneciaAutorizado}"
                                                  longitud="100"/>


                    <h:outputLabel value="*Foto:"/>
                    <h:panelGroup>
                        <p:fileUpload  mode="advanced" auto="true" label="Seleccione" dragDropSupport="false"
                                       sizeLimit="10000000"  allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                       fileUploadListener="#{faunaController.handleFileFotoCuantitativoUpload}"
                                       update="txtImg1"/>
                        <h:outputText id="txtImg1" value="#{faunaController.faunaBean.detalleFauna1.adjunto.nombre}" />
                    </h:panelGroup>
                    <h:outputLabel value="*Descripción foto:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.descripcionFoto}" identificador="txtSensibilidad1" tamanio="30" longitud="100" requerido="true"/>

                </h:panelGrid>
                <br/>
                <center>
                    <p:commandButton action="#{faunaController.agregarTablaIndividuo1()}" value="Agregar" 
                                     oncomplete="handleIndividuoHerpetofaunaRequest1(xhr, status, args)" styleClass="primary"
                                     update="frmDetalleHerpetofauna1, :#{p:component('msgs')}, :#{p:component('tblClIndividuoHerpetofauna1')}"/>
                </center>
            </p:panel>
        </h:form>
    </p:dialog>
    <script type="text/javascript">
        function handleIndividuoHerpetofaunaRequest1(xhr, status, args) {
            if (args.validationFailed || !args.puntoIndividuo1) {
                PF('dlgDetalleHerpetofauna1').jq.effect("shake", {times: 5}, 100);
            }
            else {
                PF('dlgDetalleHerpetofauna1').hide();
                $('#loginLink').fadeOut();
            }
        }
    </script>

</ui:composition>
