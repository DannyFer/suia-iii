<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:controles-prime="http://java.sun.com/jsf/composite/controles-prime"
                xmlns:control="http://java.sun.com/jsf/composite/controles-prime"
                xmlns:mae="http://java.sun.com/jsf/composite/mae-composite">
    <h:form rendered="#{faunaController.faunaBean.idTipoMuestreo != null and faunaController.faunaBean.grupoTaxonomicoSeleccionado.id == faunaController.faunaBean.idMacroinvertebradosAcuaticos}">
        <p:panelGrid columns="1" layout="grid" styleClass="w100" columnClasses="" >
            <f:facet name="header">
                <p:commandButton value="Adicionar"  styleClass="button-small-text toRight field_mrg" icon="ui-icon-plusthick" 
                                 action="#{faunaController.agregarIndividuo(1)}" update=":#{p:component('frmDetalleMacroinvertebrados1')}" 
                                 oncomplete="PF('dlgDetalleMacroinvertebrados1').show();"                />
                <mae:panelGridHeaderHelp value="Cuantitativo" conector="ubicacionHelp" image="#{request.contextPath}/resources/images/proyecto-mapa.png" help="" />

            </f:facet>
            <p:dataTable id="tblClIndividuoMacroinvertebrados1" value="#{faunaController.faunaBean.listaDetalleFauna1}"
                         var="individuo" paginator="true" rows="10" paginatorPosition="bottom" scrollable="true" scrollWidth="700"
                         emptyMessage="#{labels['common.table.empty']}">
                <p:column headerText="Acciones" width="60">
                    <div class="buttons-inline">
                        <p:commandButton icon="ui-icon-pencil" action="#{faunaController.seleccionarDetalleFauna1(individuo)}"
                                         title="Editar" styleClass="primary"
                                         oncomplete="PF('dlgDetalleMacroinvertebrados1').show();" update=":#{p:component('frmDetalleMacroinvertebrados1')}"/>
                        <p:commandButton icon="ui-icon-trash" action="#{faunaController.removerDetalleFuna1(individuo)}"
                                         title="Remover" styleClass="secondary"
                                         update="tblClIndividuoMacroinvertebrados1"/>
                    </div>
                </p:column>
                <p:column headerText="Punto de muestreo" width="240">
                    <center>
                        <control:combo identificador="cmbPuntoTbl1" lista="#{faunaController.faunaBean.listaCodigoPunto1}" 
                                       valor="#{individuo.idPuntoMuestreo}" habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Clase" width="50">
                    <center>
                        <h:outputText value="#{individuo.numeroRegistro}"/>
                    </center>
                </p:column>
                <p:column headerText="Órden" width="240">
                    <center>
                        <h:outputText value="#{individuo.orden}" />
                    </center>
                </p:column>
                <p:column headerText="Familia" width="240">
                    <center>
                        <h:outputText value="#{individuo.familia}"/>
                    </center>
                </p:column>
                <p:column headerText="Género" width="240">
                    <center>
                        <h:outputText value="#{individuo.genero}" />
                    </center>
                </p:column>
                <p:column headerText="Especie" width="240">
                    <center>
                        <h:outputText value="#{individuo.especie}"/>
                    </center>
                </p:column>
                <p:column headerText="Sistemas hidrográficos" width="240">
                    <center>
                        <control:combo identificador="cmbSistemasHicrograficosTbl1" 
                                       lista="#{combosFaunaController.listaSistemasHidrograficos}" 
                                       valor="#{individuo.idSistemasHidrograficos}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Especies bioindicadoras de la calidad del agua" width="240">
                    <center>
                        <control:combo valor="#{individuo.idEspecieBioindicadoraCalidadAgua}" 
                                       lista="#{combosFaunaController.listaEspecieBioindicadoraCalidadAgua}" 
                                       identificador="cmbDisTipoRegistroTbl1" 
                                       habilitar="true" />
                    </center>
                </p:column>

                <p:column headerText="Criterio" width="240">
                    <center>
                        <h:outputText value="#{individuo.criterio}" />
                    </center>
                </p:column>
                <p:column headerText="Época del año" width="240">
                    <center>
                        <control:combo identificador="cmbEpocadelAnioTbl" 
                                       lista="#{combosFaunaController.listaEpocaDelAnio}" 
                                       valor="#{individuo.idEpocaDelAnio}" 
                                       habilitar="true"/>
                    </center>
                </p:column>
                <p:column headerText="Grupos  Tróficos" width="240">
                    <center>
                        <control:combo identificador="cmbGruposTroficosTbl1" 
                                       lista="#{combosFaunaController.listaGruposTroficos}" 
                                       valor="#{individuo.idGruposTroficos}" 
                                       habilitar="true"/>
                    </center>
                </p:column>

                <p:column headerText="Hábito alimenticio" width="240">
                    <center>
                        <control:combo identificador="cmbEspEndemicaTbl" 
                                       lista="#{combosFaunaController.listaHabitoAlimenticio}" 
                                       valor="#{individuo.idHabitoAlimenticio}" 
                                       habilitar="true"/>
                    </center>
                </p:column>

                <p:column headerText="Ditribución en la columna de agua" width="240">
                    <center>
                        <control:combo identificador="cmbDistColumnaAgua1" 
                                       lista="#{combosFaunaController.listaDistribucionColumnaAgua}" 
                                       valor="#{individuo.idDistribucionColumnaAgua}" 
                                       habilitar="true"/>
                    </center>
                </p:column>

                <p:column headerText="N° colección del centro de tenencia" width="240">
                    <center>
                        <h:outputText value="#{individuo.coleccionCentroTenencia}" />
                    </center>
                </p:column>

                <p:column headerText="Centro tenencia autorizado" width="240">
                    <center>
                        <h:outputText value="#{individuo.centroTeneciaAutorizado}" />
                    </center>
                </p:column>
                <p:column headerText="Foto (gif,jpg,png)" width="240">
                    <center>
                        <h:outputText value="#{individuo.adjunto.nombre}" />
                    </center>
                </p:column>
                <p:column headerText="Descripción foto" width="240">
                    <center>
                        <h:outputText value="#{individuo.descripcionFoto}" />
                    </center>
                </p:column>
                <p:column headerText="Riqueza" width="240">
                    <center>
                        <h:outputText value="#{individuo.detalleFaunaEspecies.riqueza}" />
                    </center>
                </p:column>
                <p:column headerText="Shannon" width="240">
                    <center>
                        <h:outputText value="#{individuo.detalleFaunaEspecies.shannon}" />
                    </center>
                </p:column>
                <p:column headerText="Simpson" width="240">
                    <center>
                        <h:outputText value="#{individuo.detalleFaunaEspecies.simpson}" />
                    </center>
                </p:column>
                <p:column headerText="EPT" width="240">
                    <center>
                        <h:outputText value="#{individuo.detalleFaunaEspecies.ept}" />
                    </center>
                </p:column>
                <p:column headerText="BMWP - col" width="240">
                    <center>
                        <h:outputText value="#{individuo.detalleFaunaEspecies.bmwpCol}" />
                    </center>
                </p:column>
                <p:column headerText="Indice" width="240">
                    <center>
                        <h:outputText value="#{individuo.detalleFaunaEspecies.indice}" />
                    </center>
                </p:column>
                <p:column headerText="Justificación" width="240">
                    <center>
                        <h:outputText value="#{individuo.detalleFaunaEspecies.justificacion}" />
                    </center>
                </p:column>
                <p:column headerText="Anexo del análisis estadístico" width="240">
                    <center>
                        <h:outputText value="" />
                    </center>
                </p:column>

            </p:dataTable>
        </p:panelGrid>
        <br/>
        <p:panelGrid columns="4" layout="grid" styleClass="w100">
            <h:outputLabel value="Suma total de riqueza*" />
            <h:outputLabel value="Suma total de abundancia*" />
            <h:outputLabel value="Shannon*" />
            <h:outputLabel value="Simpson*" />
            <controles-prime:soloTextoNumerosDecimales identificador="txtRiqueza1" 
                                                       valor="#{faunaController.faunaBean.detalleFaunaSumaEspecies.sumaRiqueza}"
                                                       tamanio="10"
                                                       longitud="6"/>
            <controles-prime:soloTextoNumerosDecimales identificador="txtAbundancia1" 
                                                       valor="#{faunaController.faunaBean.detalleFaunaSumaEspecies.sumaAbundancia}"
                                                       tamanio="10"
                                                       longitud="6"/>
            <controles-prime:soloTextoNumerosDecimales identificador="txtShannon1" 
                                                       valor="#{faunaController.faunaBean.detalleFaunaSumaEspecies.sumaShannon}"
                                                       tamanio="10"
                                                       longitud="6"/>
            <controles-prime:soloTextoNumerosDecimales identificador="txtSimpson1" 
                                                       valor="#{faunaController.faunaBean.detalleFaunaSumaEspecies.sumaSimpson}"
                                                       tamanio="10"
                                                       longitud="6"/>

        </p:panelGrid>
        <br/>
        <div class="buttons main">
            <p:commandButton value="Guardar" action="#{faunaController.guardarCuantitativMacroinvertebrados()}" 
                             icon="ui-icon-check"
                             update=":#{p:component('frmDatos')}, :#{p:component('tblTablas')}"/>
            <p:commandButton value="Cancelar" action="/pages/eia/fauna/gruposTaxonomicos.jsf" 
                             styleClass="secondary" icon="ui-icon-cancel"
                             ajax="false" immediate="true"/>
        </div>
    </h:form>

    <p:dialog header="Detalle fauna" widgetVar="dlgDetalleMacroinvertebrados1" modal="true" resizable="false" draggable="false"
              style="overflow: auto;" width="868" height="450">  
        <h:form id="frmDetalleMacroinvertebrados1">
            <p:panel>
                <h:panelGrid columns="4">
                    <h:outputLabel value="*Punto de muestreo:"/>
                    <control:combo identificador="cmbPunto1" lista="#{faunaController.faunaBean.listaCodigoPunto1}" valor="#{faunaController.faunaBean.detalleFauna1.idPuntoMuestreo}" requerido="true"/>
                    <h:outputLabel value="*Clase:"/>
                    <h:outputText value="#{faunaController.faunaBean.detalleFauna1.numeroRegistro}"/>
                    <h:outputLabel value="*Órden:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.orden}" identificador="txtOrden1" tamanio="10" longitud="100" requerido="true"/>
                    <h:outputLabel value="*Familia:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.familia}" identificador="txtFamilia1" tamanio="30" longitud="100" requerido="true"/>
                    <h:outputLabel value="*Género:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.genero}" identificador="txtGenero1" tamanio="30" longitud="100" requerido="true"/>
                    <h:outputLabel value="*Especie:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.especie}" identificador="txtEspecie1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Sistemas hidrográficos:"/>
                    <control:combo identificador="cmbSistemaHidrograficos1" lista="#{combosFaunaController.listaSistemasHidrograficos}" valor="#{faunaController.faunaBean.detalleFauna1.idSistemasHidrograficos}" requerido="true"/>

                    <h:outputLabel value="*Especies bioindicadoras de la calidad del agua:"/>
                    <control:combo identificador="cmbEspeciesBioindicadorasCalidadAgua" lista="#{combosFaunaController.listaEspecieBioindicadoraCalidadAgua}" valor="#{faunaController.faunaBean.detalleFauna1.idEspecieBioindicadoraCalidadAgua}" requerido="true"/>

                    <h:outputLabel value="*Criterio:"/>                
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.criterio}" identificador="txtPunto1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Época del año:"/>
                    <control:combo identificador="cmbEpocaAnio1" lista="#{combosFaunaController.listaEpocaDelAnio}" valor="#{faunaController.faunaBean.detalleFauna1.idEpocaDelAnio}" requerido="true"/>

                    <h:outputLabel value="*Grupos Tróficos:"/>
                    <control:combo identificador="cmbGruposTroficos1" lista="#{combosFaunaController.listaGruposTroficos}" valor="#{faunaController.faunaBean.detalleFauna1.idGruposTroficos}" requerido="true"/>

                    <h:outputLabel value="*Hábito alimenticio :"/>
                    <control:combo identificador="cmbHabitoAlimenticio1" lista="#{combosFaunaController.listaHabitoAlimenticio}" valor="#{faunaController.faunaBean.detalleFauna1.idHabitoAlimenticio}" requerido="true"/>

                    <h:outputLabel value="*Distribución en la columna de agua:"/>
                    <control:combo identificador="cmbDisColumnaAgua1" lista="#{combosFaunaController.listaDistribucionColumnaAgua}" valor="#{faunaController.faunaBean.detalleFauna1.idDistribucionColumnaAgua}" requerido="true"/>


                    <h:outputLabel value="*N° colección del centro de tenencia:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.coleccionCentroTenencia}" identificador="txtPuntsso1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Centro tenencia autorizado:"/>
                    <control:todoTextoComoIngrese identificador="txtCentroTenencia1" tamanio="30"
                                                  valor="#{faunaController.faunaBean.detalleFauna1.centroTeneciaAutorizado}"
                                                  longitud="100"/>


                    <h:outputLabel value="*Foto:"/>
                    <h:panelGroup>
                        <p:fileUpload  mode="advanced" auto="true" label="Seleccione" dragDropSupport="false"
                                       sizeLimit="10000000"  allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
                                       fileUploadListener="#{faunaController.handleFileFotoCuantitativoUpload}"
                                       update="txtImg1"/>
                        <h:outputText id="txtImg1" value="#{faunaController.faunaBean.detalleFauna1.adjunto.nombre}" />
                    </h:panelGroup>

                    <h:outputLabel value="*Descripción foto:"/>
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.descripcionFoto}" identificador="txtSensibilidad1" tamanio="30" longitud="100" requerido="true"/>

                    <h:outputLabel value="*Riqueza:" />
                    <controles-prime:soloTextoNumerosDecimales identificador="txtRiqueza1Tbl" 
                                                               valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.riqueza}"
                                                               tamanio="10"
                                                               longitud="6"
                                                               requerido="true"/>

                    <h:outputLabel value="*Abundancia:" />
                    <controles-prime:soloTextoNumerosDecimales identificador="txtAbundancia1Tbl" 
                                                               valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.abundancia}"
                                                               tamanio="10"
                                                               longitud="6"
                                                               requerido="true"/>
                    <h:outputLabel value="*Shannon" />
                    <controles-prime:soloTextoNumerosDecimales identificador="txtShannon1Tbl" 
                                                               valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.shannon}"
                                                               tamanio="10"
                                                               longitud="6"
                                                               requerido="true"/>

                    <h:outputLabel value="*Simpson" />
                    <controles-prime:soloTextoNumerosDecimales identificador="txtSimpson1Tbl" 
                                                               valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.simpson}"
                                                               tamanio="10"
                                                               longitud="6"
                                                               requerido="true"/>

                    <h:outputLabel value="*EPT" />
                    <controles-prime:soloTextoNumerosDecimales identificador="txtEPT1Tbl" 
                                                               valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.ept}"
                                                               tamanio="10"
                                                               longitud="6"/>

                    <h:outputLabel value="*BMWP - col"/>
                    <controles-prime:soloTextoNumerosDecimales identificador="txtBMWPcoln1Tbl" 
                                                               valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.bmwpCol}"
                                                               tamanio="10"
                                                               longitud="6"
                                                               requerido="true"/>

                    <h:outputLabel value="Indice" />
                    <controles-prime:soloTextoNumerosDecimales identificador="txtIndice1Tbl" 
                                                               valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.indice}"
                                                               tamanio="10"
                                                               longitud="6"/>

                    <h:outputLabel value="Justificación" />
                    <control:todoTextoComoIngrese valor="#{faunaController.faunaBean.detalleFauna1.detalleFaunaEspecies.justificacion}" identificador="txtJustificacion1" tamanio="30" longitud="100"/>

                    <h:outputLabel value="Anexo del análisis estadístico" />
                    <p:fileUpload  mode="advanced" auto="true" label="Seleccione" dragDropSupport="false"
                                   sizeLimit="1000000"  allowTypes="/(\.|\/)(pdf)$/" />
                </h:panelGrid>
                <br/>
                <center>
                    <p:commandButton action="#{faunaController.agregarTablaIndividuo1()}" value="Agregar" 
                                     oncomplete="handleIndividuoMacroinvertebradosRequest1(xhr, status, args)" styleClass="primary"
                                     update="frmDetalleMacroinvertebrados1, :#{p:component('msgs')}, :#{p:component('tblClIndividuoMacroinvertebrados1')}"/>
                </center>
            </p:panel>
        </h:form>
    </p:dialog>
    <script type="text/javascript">
        function handleIndividuoMacroinvertebradosRequest1(xhr, status, args) {
            if (args.validationFailed || !args.puntoIndividuo1) {
                PF('dlgDetalleMacroinvertebrados1').jq.effect("shake", {times: 5}, 100);
            }
            else {
                PF('dlgDetalleMacroinvertebrados1').hide();
                $('#loginLink').fadeOut();
            }
        }
    </script>

</ui:composition>
